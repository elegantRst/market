import{d as I,r as m,u,b as F,f as D,S as k,j as o,T as q,o as B,g as y,h as U,i as V,k as z,D as R,l as G,n as O,p as W,q as H,t as Y,L as J,v as K,c as L,w as Q,x as X,y as Z,z as $,e as P}from"./index-TJ6Z515T.js";import{B as oo,S as eo}from"./Subscribe-CfEojRyV.js";import{a as E,S as M}from"./selectors-CpYoHOBA.js";import{s as l,F as so}from"./FeedbacksItem-e1GDbg7U.js";import{f as C}from"./formatNumbers-DT4AwJLE.js";import{n as _o}from"./normalizeWordsForm-COjRfoeh.js";import{O as no}from"./onClickAddToCart-D5-9r9mT.js";import{S as T}from"./index-BMlK8rzT.js";import{L as to}from"./LightboxModal-BiCH0iq5.js";import{C as io}from"./Card-CxM1sY1H.js";const ao=(e=".")=>{let n=new Date,r=n.getDate(),i=n.getMonth()+1,a=n.getFullYear();return`${r}${e}${i<10?`0${i}`:`${i}`}${e}${a}`},ro=(e=":")=>{let n=new Date,r=n.getHours(),i=n.getMinutes();return`${r<10?`0${r}`:`${r}`}${e}${i<10?`0${i}`:`${i}`}`},co=({findProduct:e})=>{const n=I(),[r,i]=m.useState([]),{user:a}=u(F),{feedbackRating:c,feedbacks:d,status:f,feedbacksAll:p,statusAll:g}=u(E),{isLogged:x}=u(F),{register:b,formState:{errors:h},handleSubmit:N}=D({mode:"onBlur",resolver:B(O)});m.useEffect(()=>{x&&f===k.SUCCESS?i(d.filter(_=>_.productId===e.id)):g===k.SUCCESS&&i(p.filter(_=>_.productId===e.id))},[]);const S=async _=>{n(y(""));const j={productId:e.id,date:ao(),time:ro(),rating:c,userId:a.id,userEmail:a.email,userName:a.name,feedbackMessage:_.feedbackMessage},w=await n(U(j));if("error"in w){const A=w.payload||w.error.message;n(y(A))}else await n(V()),n(y(z.successAddedFeedback)),window.location.reload(),R(!0,e,H,W)},t=()=>{n(G(!0))};return o.jsx(o.Fragment,{children:o.jsxs("section",{className:l.product_feedback,id:"feedbacks",children:[o.jsx("div",{className:"title_head",children:o.jsx("h2",{className:"title_head__title",children:"Отзывы"})}),o.jsxs("div",{className:l.product_feedback__inner,children:[r?.length>0?o.jsx("div",{className:l.product_feedback__items,children:r.map((_,j)=>o.jsx(so,{item:_,ix:j},j))}):o.jsx("p",{className:l.product_feedback__inner_text,children:"Нет никаких отзывов на этот продукт."}),x?o.jsxs("form",{className:l.product_feedback__inner_form,onSubmit:N(S),children:[o.jsx("div",{className:l.product_feedback__inner_title,children:"Добавить ваш отзыв"}),o.jsxs("div",{className:l.product_feedback__inner_ratebox,children:[o.jsx("p",{className:l.product_feedback__inner_text,children:"Рейтинг"}),o.jsx(M,{rating:c,editValue:!0})]}),o.jsxs("div",{className:l.product_feedback__form_box,children:[o.jsx(q,{className:l.product_feedback__form_textarea,label:"Напишите ваш отзыв",...b("feedbackMessage"),variant:"outlined",multiline:!0,rows:5,error:!!h.feedbackMessage,helperText:h.feedbackMessage?`${h.feedbackMessage.message}`:""}),o.jsx("button",{className:l.product_feedback__form_button,type:"submit",children:"Отправить"})]})]}):o.jsxs(o.Fragment,{children:[o.jsx("p",{className:l.isNoLogged,children:"Выполните вход, для того чтобы оставить ваш отзыв."}),o.jsx("button",{className:l.login,onClick:()=>t(),children:"Войти"})]})]})]})})},lo="_product_info__images_image_1yepn_1",fo="_product_info__images_slide_1yepn_10",mo="_product_info__image_expand_1yepn_22",v={product_info__images_image:lo,product_info__images_slide:fo,product_info__image_expand:mo},po=({findProduct:e})=>{const r={slidesToShow:1,slidesToScroll:1,lazyLoad:"ondemand",infinite:!0,arrows:!1,fade:!0},i={slidesToShow:(e.slides?.length||0)<=4?e.slides?.length||1:4,slidesToScroll:1,lazyLoad:"ondemand",infinite:!0},[a,c]=m.useState(null),[d,f]=m.useState(null),[p,g]=m.useState(null),[x,b]=m.useState(0),h=(t,_)=>{g(t),b(_)},N=()=>{const t=e.slides?.length;if(!t)return 0;if(!e.slides)return;const _=x===0?t-1:x-1;g(e.slides[_]),b(_)},S=()=>{const t=e.slides?.length;if(!t)return 0;if(!e.slides)return;const _=(x+1)%t;g(e.slides[_]),b(_)};return o.jsxs(o.Fragment,{children:[o.jsx(T,{className:"product_info__images_image",...r,asNavFor:d??void 0,ref:t=>c(t),children:e.slides?.map((t,_)=>o.jsxs("div",{className:v.product_info__images_image,onClick:()=>h(t,_),children:[o.jsx("img",{src:t,alt:"изображение товара"}),o.jsx("span",{className:v.product_info__image_expand})]},_))}),o.jsx(T,{className:"product_info__images_slider",...i,asNavFor:a??void 0,ref:t=>f(t),children:e.slides?.map((t,_)=>o.jsx("div",{className:v.product_info__images_slide,onClick:()=>h(t,_),children:o.jsx("img",{src:t,alt:"миниатюра"})},_))}),p&&o.jsx(to,{clickedImage:p,imageNext:S,imagePrev:N,setClickedImage:g})]})},uo="_product_info_2n5p9_1",go="_product_info__inner_2n5p9_19",xo="_product_info__inner_images_2n5p9_30",ho="_product_info__inner_information_2n5p9_35",bo="_product_info__information_name_box_2n5p9_41",jo="_product_info__information_rate_2n5p9_49",ko="_product_info__information_name_2n5p9_41",No="_product_info__information_feedbacks_2n5p9_63",So="_product_info__information_addfeedbacks_2n5p9_71",wo="_product_info__information_price_box_2n5p9_82",yo="_product_info__information_price_2n5p9_82",vo="_product_info__information_price_span_2n5p9_96",Fo="_product_info__information_buy_box_2n5p9_106",To="_product_info__card__form_button_2n5p9_115",$o="_product_info__information_text_box_2n5p9_212",Co="_product_info__information_text_title_2n5p9_222",Io="_product_info__information_category_box_2n5p9_228",Lo="_product_info__information_category_line_2n5p9_238",Eo="_green_2n5p9_247",Mo="_red_2n5p9_250",Ao="_color_2n5p9_254",Do="_product_info__information_category_span_2n5p9_268",qo="_product_info__information_socials_box_2n5p9_276",Bo="_product_info__information_socials_item_2n5p9_283",s={product_info:uo,product_info__inner:go,product_info__inner_images:xo,product_info__inner_information:ho,product_info__information_name_box:bo,product_info__information_rate:jo,product_info__information_name:ko,product_info__information_feedbacks:No,product_info__information_addfeedbacks:So,product_info__information_price_box:wo,product_info__information_price:yo,product_info__information_price_span:vo,product_info__information_buy_box:Fo,product_info__card__form_button:To,product_info__information_text_box:$o,product_info__information_text_title:Co,product_info__information_category_box:Io,product_info__information_category_line:Lo,green:Eo,red:Mo,color:Ao,product_info__information_category_span:Do,product_info__information_socials_box:qo,product_info__information_socials_item:Bo},Uo=({findProduct:e})=>{const{status:n,feedbacks:r}=u(E),{isLogged:i}=u(F),{hash:a,key:c}=Y();m.useEffect(()=>{window.scrollTo(0,0)},[]),m.useEffect(()=>{a&&a.length>1&&document.getElementById(a.substring(1))?.scrollIntoView({behavior:"smooth"})},[c,a]);const d=n===k.SUCCESS?r.filter(f=>f.productId===e.id):[];return o.jsx(o.Fragment,{children:o.jsx("section",{className:s.product_info,children:o.jsxs("div",{className:s.product_info__inner,children:[o.jsx("div",{className:s.product_info__inner_images,children:o.jsx(po,{findProduct:e})}),o.jsxs("div",{className:s.product_info__inner_information,children:[o.jsxs("div",{className:s.product_info__information_name_box,children:[o.jsx("div",{className:s.product_info__information_name,children:e?.name}),o.jsx("div",{className:s.product_info__information_rate,children:o.jsx(M,{rating:e?.rating,editValue:!1})}),o.jsxs("div",{className:s.product_info__information_feedbacks,children:[d.length,_o(d.length)]}),o.jsx(J,{className:s.product_info__information_addfeedbacks,to:"#feedbacks",children:"Добавить отзыв"})]}),o.jsx("div",{className:s.product_info__information_price_box,children:o.jsxs("div",{className:s.product_info__information_price,children:[C(e?.price)," р",o.jsxs("span",{className:s.product_info__information_price_span,children:[C(e?.salePrice)," р"]})]})}),i&&o.jsx("div",{className:s.product_info__information_buy_box,children:o.jsxs("button",{className:s.product_info__card__form_button,type:"button",onClick:()=>no(e),children:[o.jsx("i",{className:"icon_shopping_basket"}),"В корзину"]})}),o.jsxs("div",{className:s.product_info__information_text_box,children:[o.jsx("div",{className:s.product_info__information_text_title,children:"Описание:"}),e?.description]}),o.jsxs("div",{className:s.product_info__information_category_box,children:[o.jsxs("div",{className:s.product_info__information_category_line,children:[o.jsx("span",{className:s.product_info__information_category_span,children:"Доступно:"}),o.jsx("strong",{className:e?.inStock?s.green:s.red,children:e?.inStock?"В наличии":"Нет в наличии"})]}),o.jsxs("div",{className:s.product_info__information_category_line,children:[o.jsx("span",{className:s.product_info__information_category_span,children:"Категория:"}),K[e?.category]?.name]}),o.jsxs("div",{className:s.product_info__information_category_line,children:[o.jsx("span",{className:s.product_info__information_category_span,children:"Цвет:"}),o.jsx("span",{className:s.color,style:{backgroundColor:`${e?.color}`}})]})]}),o.jsxs("div",{className:s.product_info__information_socials_box,children:[o.jsx("a",{className:`${s.product_info__information_socials_item} icon_facebook_square socials__color_facebook`,href:"https://www.facebook.com/",children:"Facebook"}),o.jsx("a",{className:`${s.product_info__information_socials_item} icon_twitter_square socials__color_twitter`,href:"https://help.twitter.com/",children:"Tweet"}),o.jsx("a",{className:`${s.product_info__information_socials_item} icon_linkedin_square socials__color_linkedin`,href:"https://www.linkedin.com/",children:"Linkedin"}),o.jsx("a",{className:`${s.product_info__information_socials_item} icon_google_plus_square socials__color_google`,href:"https://www.google.ru/",children:"Google+"}),o.jsx("a",{className:`${s.product_info__information_socials_item} icon_pinterest_square socials__color_pinterest`,href:"https://www.pinterest.ru/",children:"Pinterest"})]})]})]})})})},Vo="_popular_1trw8_1",zo={popular:Vo},Ro=({category:e})=>{const{productsAll:n}=u(L),i=((c,d,f)=>c.filter(p=>p[d]===f))(n,"category",e),a={slidesToShow:4,slidesToScroll:4,arrows:!1,dots:!0,autoplay:!0,autoplaySpeed:3500,cssEase:"ease-out",responsive:[{breakpoint:1251,settings:{slidesToShow:3,slidesToScroll:3,variableWidth:!1}},{breakpoint:801,settings:{slidesToShow:2,slidesToScroll:2,variableWidth:!1}},{breakpoint:551,settings:{slidesToShow:1,slidesToScroll:1,variableWidth:!1}}]};return o.jsxs("section",{className:zo.popular,children:[o.jsx("div",{className:"title_head",children:o.jsx("h2",{className:"title_head__title",children:"Популярное"})}),o.jsx(T,{className:"popular__slider",...a,children:i.map(c=>o.jsx(io,{obj:c},c.id))})]})},Po=()=>{const e=I(),n=Q(),{productsAll:r,statusAll:i}=u(L),{menuUrlValue:a}=u(X),{id:c}=Z(),d=r?.find(p=>p.id===Number(c)),f=d?.name;return m.useEffect(()=>{e($(!1)),e(P(""))},[a,e]),m.useEffect(()=>{window.scrollTo(0,0),e($(!1))},[c,e]),o.jsx(o.Fragment,{children:i===k.LOADING?"Идёт загрузка!":o.jsxs(o.Fragment,{children:[o.jsx(oo,{pageTitle:f}),d?o.jsxs(o.Fragment,{children:[o.jsx(Uo,{findProduct:d}),o.jsx(co,{findProduct:d}),o.jsx(Ro,{category:d?.category})]}):n("error"),o.jsx(eo,{})]})})};export{Po as default};
